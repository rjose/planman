<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <script src="js/jquery-1.8.2.min.js"></script>
    <script src="js/state-machine.js"></script>
    <script src="js/task.js"></script>
</head>

<body>
<canvas id="myCanvas" width="800" height="600" style="border:1px solid #333;">
</canvas>


<script>
    "use strict";
    var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");

    // State machine
    var stateMachine = new StateMachine(c);

    // TODO: Need a way to re-render everything
    // TODO: Figure out a better place to store the tasks
    stateMachine.tasks.forEach(function(task) {
        task.render(ctx);
    });


    function handleTaskSelected(event) {
        var task = event.detail.task;
        task.showControls(ctx);
    }

    function handleMouseEvent(event) {
        stateMachine.transition(event);
    }

    c.addEventListener("mousedown", handleMouseEvent, false);
    c.addEventListener("mouseup", handleMouseEvent, false);
    c.addEventListener("taskSelected", handleTaskSelected, false);
</script>
</body>

</html>
